- name: Install build related tools
  apt:
    name: "{{ packages }}"
    install_recommends: yes
    state: latest
  vars:
    packages:
    - make
    - cmake
    - gcc
    - m4
    - clang-8
    - clang-format-8
    - clang-tidy-8
    - doxygen
    - graphviz
    - valgrind
    - gdb
    - iwyu
    - texlive-latex-base
    - texlive-binaries

- name: Add Git PPA
  apt_repository:
    repo: ppa:git-core/ppa
    update_cache: yes

- name: Install Git
  apt:
    name: "{{ packages }}"
    install_recommends: yes
    state: latest
  vars:
    packages:
    - git
    - git-lfs

- name: Check global Git credential helper status
  shell: git config --system --get credential.helper
  ignore_errors: yes
  changed_when: no
  no_log: True
  register: git_cred_helper

- name: Enable Git credential cache
  command: git config --system credential.helper 'cache'
  when: ("git-credential-helper" not in git_cred_helper.stdout)
